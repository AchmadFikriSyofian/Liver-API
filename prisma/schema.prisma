// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users {
  id  Int @id @default(autoincrement())
  name String
  email String @unique
  password String
  no_hp String
  jenis_kelamin String?
  is_admin Boolean @default(false)
  enrollment Enrollments[]
}

model Categories {
  id Int @id @default(autoincrement())
  name String
  course CategoriesOnCourses[]
}

model Mentors {
  id Int @id @default(autoincrement())
  name String
  course MentorsOnCourses[]
}

model Courses {
  id Int @id @default(autoincrement())
  name String
  desc String
  price String
  level Level
  type Type @default(isFree)
  chapter Chapters[]
  enrollment Enrollments[]
  mentor MentorsOnCourses[]
  category CategoriesOnCourses[]
}

// Explicit Mentor and Course 
model MentorsOnCourses {
  mentor_id Int
  mentor Mentors @relation(fields: [mentor_id], references: [id])
  course_id Int
  course Courses @relation(fields: [course_id], references: [id])
  assignedAt DateTime @default(now())

  @@id([mentor_id, course_id])
}

// Explicit Category and Course
model CategoriesOnCourses {
  category_id Int
  category Categories @relation(fields: [category_id], references: [id])
  course_id Int
  course Courses @relation(fields: [course_id], references: [id])

  @@id([category_id, course_id])
}

enum Type {
  isFree
  isPremium
  isPromo
}

enum Level {
  Beginner
  Intermediate
  Advanced
}

model Chapters {
  id Int @id @default(autoincrement())
  name String
  lesson Lessons[]
  course_id_chapter Int
  course Courses @relation(fields: [course_id_chapter], references: [id])
}

model Lessons {
  id Int @id @default(autoincrement())
  name String
  video String
  desc String
  chapter_id Int
  chapter Chapters @relation(fields: [chapter_id], references: [id])
}

model Enrollments {
  id Int @id @default(autoincrement())
  payment String?
  user_id Int
  user Users @relation(fields: [user_id], references: [id])
  course_id_enrollment Int
  course Courses @relation(fields: [course_id_enrollment], references: [id])
}